/*---------------------------------------------------------------
                           WEB PAGES
---------------------------------------------------------------*/
//---------------------------------------------------------------
const String auth_Body1_Rem ="<body><div class=\"container\"><div class=\"page-header\"><h1>IoT Web Server</h1><p>...Plataforma para el internet de las cosas...</p></div><div class=\"row\"><div class=\"container\"><div class=\"col-md-6\"><div class=\"thumbnail\"><img src=\"https://cdn.pixabay.com/photo/2018/05/16/05/07/iot-3404892_960_720.jpg\" alt=\"\" class=\"img-rounded\"></div></div><div class=\"col-md-6\">";
const String auth_Body1_Loc ="<body><div class=\"container\"><div class=\"page-header\"><h1>IoT Web Server</h1><p>...Plataforma para el internet de las cosas...</p></div><div class=\"row\"><div class=\"container\"><div class=\"col-md-6\"><div class=\"thumbnail\"><img src=\"iot-3404892_960_720.jpg\" alt=\"\" class=\"img-rounded\"></div></div><div class=\"col-md-6\">";
const String auth_Body2 ="<div class=\"jumbotron\"><h2>Inicio de Sesión</h2><p>Por favor inicie sesión para continuar:</p><form method=\"post\" class=\"form-group\" action=\"main\"><table align=\"center\"><tr><td><div class=\"input-group\"><span class=\"input-group-addon\"><i class=\"glyphicon glyphicon-user\"></i></span><input type=\"text\" name=\"txtUser\" class=\"form-control\" id=\"user\" placeholder=\"Nombre de Usuario\" required></div></td></tr><tr><td><div class=\"input-group\"><span class=\"input-group-addon\"><i class=\"glyphicon glyphicon-lock\"></i></span><input type=\"password\" name=\"txtPass\" class=\"form-control\" id=\"pass\" placeholder=\"Contraseña\" required></div></td></tr><tr><td>&nbsp;<input type=\"reset\" name=\"btnBborrar\" value=\"Borrar\" class=\"btn btn-danger\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=\"submit\" name=\"btnAcceder\" value=\"Acceder\" class=\"btn btn-primary\" ></td></tr></table></form></div></div></div></div></div>";
const String auth_Page_Denied ="<div class=\"alert alert-danger\"><p align=\"center\"><span class=\"glyphicon glyphicon-exclamation-sign\"></span>&nbsp;&nbsp;&nbsp;Nombre de usuario y/o contraseña incorrectos. Por favor intente nuevamente</p></div>";
const String auth_Page_LoggedOut ="<div class=\"alert alert-success\"><p align=\"center\"><span class=\"glyphicon glyphicon-ok\"></span>&nbsp;&nbsp;&nbsp;Ha cerrado sesión en IoT Web Server.</p></div>";
const String page_footer ="<footer class='footer'><div class='container-fluid' style='background-color: black'><p class='text-muted' align='center'>Desarrollado por: Javier Ruzzante Calderón</p><p class='text-muted' align='center'>ULA Facultad de Ingeniería - Escuela de Ingeniería Eléctrica</p><p class='text-muted' align='center'>Mérida - 2020</p></div></footer></html></!DOCTYPE>";
//const String page_Head_Rem="<!DOCTYPE HTML><html><head><meta name='viewport' content='width=device-width, initial-scale=1'><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"/><title>JRC ESP-12E: Servidor Web PIC18F452</title><link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css'><script src='https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js'></script><script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js'></script><script src='http://jrctech.000webhostapp.com/iot/script_mainV2.js'></script><link rel='stylesheet' href='http://jrctech.000webhostapp.com/iot/styles.css'><link rel='icon' href='data:;base64,iVBORw0KGgo='></head><body>";
const String page_Head_Rem="<!DOCTYPE HTML><html><head><meta name='viewport' content='width=device-width, initial-scale=1'><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"/><title>JRC ESP-12E: Servidor Web PIC18F452</title><link rel='stylesheet' href='http://jrctech.000webhostapp.com/iot/bootstrap/css/bootstrap.min.css'><script src='http://jrctech.000webhostapp.com/iot/jquery.min.js'></script><script src='http://jrctech.000webhostapp.com/iot/bootstrap/js/bootstrap.min.js'></script><script src='http://jrctech.000webhostapp.com/iot/script_mainV2.js'></script><link rel='stylesheet' href='http://jrctech.000webhostapp.com/iot/styles.css'><link rel='icon' href='data:;base64,iVBORw0KGgo='></head><body>";
const String page_Head_Loc="<!DOCTYPE HTML><html><head><meta name='viewport' content='width=device-width, initial-scale=1'><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"/><title>JRC ESP-12E: Servidor Web PIC18F452</title><link rel='stylesheet' href='bootstrap.min.css'><script src='jquery.min.js'></script><script src='bootstrap.min.js'></script><script src='script_mainV2.js'></script><link rel='stylesheet' href='styles.css'><link rel='icon' href='data:;base64,iVBORw0KGgo='></head><body>";

const String nav1="<nav class='navbar navbar-inverse'><div class='container-fluid'><div class='navbar-header'><button type='button' class='navbar-toggle' data-toggle='collapse' data-target='#myNavbar'><span class='icon-bar'></span><span class='icon-bar'></span><span class='icon-bar'></span>                   </button><a class='navbar-brand' href='#'>IoT Web Server</a></div><div class='collapse navbar-collapse' id='myNavbar'><ul class='nav navbar-nav'><li><a href='#' onclick='homeClick()'>Control Principal</a></li><li><a href='#' onclick='visorClick()'>Visor de Eventos</a></li><li><a href='#' onclick='actualizarRTC()'>Actualizar Reloj</a></li></ul><form class='navbar-form navbar-right' method='get' id='formulario'><div class='form-group'><label for='token' class='text-success'>Token:</label><input type='text' name='txtToken' value='";                            

const String nav2="' size='5' class='form-control' id='token' disabled></div><div class='form-group'><input type='text' name='logout' value='1' hidden ><input type='button' name='btnLogout' value='Cerrar Sesión' class='btn btn-danger' onclick='cerrarSesion()'></div></form></div></div></nav>";

const String body1="<div class='container'><div class='page-header'><div class='row'><div class='col-md-6'><div class='jumbotron'><h1>Panel de Control Principal</h1><p><span style='color:green;font-weight:bold'>Desde aqui podrá monitorear y controlar todos los aspectos del sistema</span></p></div></div><div class='col-md-6'><div class='thumbnail'><span>";

const String panel_Rem="<img src='http://jrctech.000webhostapp.com/iot/panel.jpg' alt='' class='img-thumbnail'>";
const String panel_Loc="<img src='panel.jpg' alt='' class='img-thumbnail'>";

const String body2="</span></div></div></div></div></div><div class='container'><div class='alert alert-success' id='alertPing'></div><div class='alert alert-info' id='alertClock'></div><div class='row' style='background-color:#6495ED;'><div class='col-md-12'><h3>Sensores:</h3></div></div><div class='row' style='background-color:#E6E6FA;'><div class='col-md-3'><b>Temperatura:</b>  <span id='Tact' style='font-weight: bold; color: green;'></span></div><div class='col-md-2'><label>Aire Acondicionado:</label>  <input type='checkbox' id='chkAC' disabled='true'></div><div class='col-md-1'><label>Auto:</label>  <input type='checkbox' id='chkACauto' checked='true' onclick='autoTemp()'></div><div class='col-md-6'><label id='lblTref'></label>  <div class='slider'> <input type='range' min='0' max='50' width='20px' id='rngTref' value='25'></div></div></div><div class='row' style='background-color:#E6E6FA;'><div class='col-sm-12'><b>Iluminación LDR1:</b>  <span id='LDR_1'  style='font-weight: bold; color: green;'></span></div></div>";

const String body3="<div class='row' style='background-color:#E6E6FA;'><div class='col-sm-12'><b>Iluminación LDR2:</b>  <span id='LDR_2'  style='font-weight: bold; color: green;'></span></div></div><div class='row' style='background-color:#E6E6FA;'><div class='col-sm-12'><b>Iluminación LDR3:</b>  <span id='LDR_3'  style='font-weight: bold; color: green;'></span></div></div><div class='row' style='background-color:#6495ED;'><div class='col-md-12'><h3>Control de Luces:</h3></div></div><div class='row' style='background-color:#E6E6FA;'><div class='col-sm-2'><label>Luz A:</label>  <input type='checkbox' id='chkLuzA' disabled='true'> </div><div class='col-sm-2'><label>Auto:</label>  <input type='checkbox' id='chkLuzAutoA' checked='true' onclick='autoLuz(\"A\")'></div><div class='col-sm-8'><label id='lblRefLuzA'></label>  <div class='slider'><input type='range' min='0' max='100' id='rngRefLuzA' value='50'></div></div></div><div class='row' style='background-color:#E6E6FA;'><div class='col-sm-2'><label>Luz B:</label>  <input type='checkbox' id='chkLuzB' disabled='true'> </div><div class='col-sm-2'><label>Auto:</label>  <input type='checkbox' id='chkLuzAutoB' checked='true' onclick='autoLuz(\"B\")'></div><div class='col-sm-8'><label id='lblRefLuzB'></label>  <div class='slider'><input type='range' min='0' max='100' id='rngRefLuzB' value='50'></div></div></div><div class='row' style='background-color:#E6E6FA;'>";

const String body4="<div class='col-sm-2'><label>Luz C:</label>  <input type='checkbox' id='chkLuzC' disabled='true'> </div><div class='col-sm-2'><label>Auto:</label>  <input type='checkbox' id='chkLuzAutoC' checked='true' onclick='autoLuz(\"C\")'></div><div class='col-sm-8'><label id='lblRefLuzC'></label>  <div class='slider'><input type='range' min='0' max='100' id='rngRefLuzC' value='50'></div></div></div><div class='row' style='background-color:#6495ED;'><div class='col-md-12'><h3>Control de Ventilación:</h3></div></div><div class='row' style='background-color:#E6E6FA;'><div class='col-md-3'><label>On/Off:</label> <input type='checkbox' id='chkVent'></input></div><div class='col-md-9'><label id='lblPow'></label><div class='slider'><input type='range' min='0' max='100' id='rngVentPow' value='50'></div></div></div><div class='row' style='background-color:#6495ED;'><div class='col-md-12'><h3>Tensiones de Alimentación:</h3></div></div><div class='row'style='background-color:#E6E6FA;'><div class='col-sm-12'><b>+12V DC</b>  <span id='V9V'  style='font-weight: bold; color: green;'></span></div><div class='col-sm-12'><b>+5V DC</b>  <span id='V5V'  style='font-weight: bold; color: green;'></span></div><div class='col-sm-12'><b>+3.3V DC</b>  <span id='V3V3'  style='font-weight: bold; color: green;'></span></div></div></div></div></body>";


/******************************************************************************
                              Visor de Eventos
*******************************************************************************/
const String visor_Body1_Rem="<div class='container'><div class='page-header'><div class='row'><div class='col-md-6'><div class='jumbotron'><h1>Visor de Eventos</h1><p><span style='color:green;font-weight:bold'>Esta seccion muestra los eventos recientes ordenados cronológicamente</span></p></div></div><div class='col-md-6'><div class='thumbnail'><span><img src='http://jrctech.000webhostapp.com/iot/visor.jpg' alt='' class='img-thumbnail'></span></div></div></div></div></div><div class='container'>";
const String visor_Body1_Loc="<div class='container'><div class='page-header'><div class='row'><div class='col-md-6'><div class='jumbotron'><h1>Visor de Eventos</h1><p><span style='color:green;font-weight:bold'>Esta seccion muestra los eventos recientes ordenados cronológicamente</span></p></div></div><div class='col-md-6'><div class='thumbnail'><span><img src='visor.jpg' alt='' class='img-thumbnail'></span></div></div></div></div></div><div class='container'>";
const String visor_Info1="<div class='alert alert-info' id='alertInfo'><strong>";
const String visor_Info2="</strong></div>";
const String visor_Table_Head="<table class='table table-hover'><thead>  <tr><th>ID</th><th>Fecha</th><th>Hora</th><th>Evento</th><th>Valor</th>  </tr></thead><tbody>";
const String visor_Body2="</tbody></table><br><ul class='pager'>";
const String visor_btnPrev="<li class='previous'><a href='#' onclick='btnPrevClick()'>Anterior</a></li>";
const String visor_btnBorrar="<li><input type='button' id='btnBorrarEEPROM' value='Borrar Registros' onclick='btnBorrarClick()' class='btn btn-danger btn-sm'></li>";
const String visor_btnNext="<li class='next'><a href='#' onclick='btnNextClick()'>Siguiente</a></li>";
const String visor_Body3="</ul></div>";

//---------------------------------------------------------------

const String http_Header="HTTP/1.1 200 OK\r\nAccess-Control-Allow-Origin:*\r\n\r\n";

//const String script_main = "<script>var ajaxActualizar=null;  var x=null;  var ping = null;  $(document).ready(function(){   if(document.getElementById('rngTref') != null){   testPing();   document.querySelector('#rngTref').addEventListener('input', function() {document.getElementById('lblTref').innerHTML = 'Temperatura de referencia: ' + document.getElementById('rngTref').value + '\u00B0C';}, false);   document.querySelector('#rngRefLuzA').addEventListener('input', function() {document.getElementById('lblRefLuzA').innerHTML = 'Nivel de referencia: ' + document.getElementById('rngRefLuzA').value + '%';}, false);   document.querySelector('#rngRefLuzB').addEventListener('input', function() {document.getElementById('lblRefLuzB').innerHTML = 'Nivel de referencia: ' + document.getElementById('rngRefLuzB').value + '%';}, false);   document.querySelector('#rngRefLuzC').addEventListener('input', function() {document.getElementById('lblRefLuzC').innerHTML = 'Nivel de referencia: ' + document.getElementById('rngRefLuzC').value + '%';}, false);   document.querySelector('#rngVentPow').addEventListener('input', function() {document.getElementById('lblPow').innerHTML = 'Potencia: ' + document.getElementById('rngVentPow').value + '%';}, false);   }  });  function testPing(){   var urlPing=getAbsolutePath() + 'ping';   ping = new Date;   $.ajax({ type: 'GET',    url: urlPing,    cache:false,    success: function(output){      ping = new Date - ping;     if(ping<1000)      timeActualizar=1500;     else if(ping<2000)      timeActualizar=3000;     else if(ping<4500)      timeActualizar=5500;     else      timeActualizar=6500;     document.getElementById('alertPing').innerHTML='<strong>Ping: </strong>'+ping+' ms. <strong>Tiempo Actualizaci&oacute;n: </strong>'+timeActualizar+ ' ms.';     x=setInterval('actualizar()',timeActualizar);          var lista = (output.split(','));     for (var i=0; i<=8; i++){      if(lista[i]=='1')       lista[i]=true;      else       lista[i]=false;     }     document.getElementById('chkAC').checked=lista[0];     document.getElementById('chkACauto').checked=lista[1];     document.getElementById('chkLuzA').checked=lista[2];     document.getElementById('chkLuzAutoA').checked=lista[3];     document.getElementById('chkLuzB').checked=lista[4];     document.getElementById('chkLuzAutoB').checked=lista[5];     document.getElementById('chkLuzC').checked=lista[6];     document.getElementById('chkLuzAutoC').checked=lista[7];     document.getElementById('chkVent').checked=lista[8];     autoTemp();     autoLuz('A');     autoLuz('B');     autoLuz('C');     document.getElementById('rngTref').value=lista[9];     document.getElementById('lblTref').innerHTML='Temperatura de referencia: '+ lista[9] + '\u00B0C';     document.getElementById('rngRefLuzA').value=lista[10];     document.getElementById('lblRefLuzA').innerHTML='Nivel de referencia: '+ lista[10] + '%';     document.getElementById('rngRefLuzB').value=lista[11];     document.getElementById('lblRefLuzB').innerHTML='Nivel de referencia: '+ lista[11] + '%';     document.getElementById('rngRefLuzC').value=lista[12];     document.getElementById('lblRefLuzC').innerHTML='Nivel de referencia: '+ lista[12] + '%';     document.getElementById('rngVentPow').value=lista[13];     document.getElementById('lblPow').innerHTML='Potencia: '+ lista[13] + '%';     $.ajaxSetup({timeout: timeActualizar, error: function(){}});    },    error: function(){setTimeout(testPing(),2000);}   });  }  function autoTemp(){   if (document.getElementById('chkACauto').checked){    document.getElementById('chkAC').disabled=true;    document.getElementById('rngTref').disabled=false;   }   else {    document.getElementById('chkAC').disabled=false;    document.getElementById('rngTref').disabled=true;   }  }  function autoLuz(luz){   if (document.getElementById('chkLuzAuto'+luz).checked){    document.getElementById('chkLuz'+luz).disabled=true;    document.getElementById('rngRefLuz'+luz).disabled=false;   }   else {    document.getElementById('chkLuz'+luz).disabled=false;    document.getElementById('rngRefLuz'+luz).disabled=true;   }  }  function trefChange(){   document.getElementById('lblTref').innerHTML='Temperatura de referencia: '+ document.getElementById('rngTref').value + '\u00B0C';  }  function refAChange(){   document.getElementById('lblRefLuzA').innerHTML='Nivel de referencia: '+ document.getElementById('rngRefLuzA').value + '%';  }  function refBChange(){   document.getElementById('lblRefLuzB').innerHTML='Nivel de referencia: '+ document.getElementById('rngRefLuzB').value + '%';  }  function refCChange(){   document.getElementById('lblRefLuzC').innerHTML='Nivel de referencia: '+ document.getElementById('rngRefLuzC').value + '%';  }  function powChange(){   document.getElementById('lblPow').innerHTML='Potencia: '+ document.getElementById('rngVentPow').value + '%';  }  function actualizar(){   if(((ajaxActualizar == null) || (ajaxActualizar.readyState==4) || (ajaxActualizar.readyState==0)) ){    url=getAbsolutePath() + 'actBits';           var dateTime=new Date();    var day=dateTime.getDate();    var month=dateTime.getMonth() + 1;    var yr=dateTime.getFullYear() - 2000;    var dow=dateTime.getDay();    var hrs=dateTime.getHours();    var min=dateTime.getMinutes();    var sec=dateTime.getSeconds();              ajaxActualizar=$.post(url,     {AC: chkAC.checked,     A_AC: chkACauto.checked,     LA: chkLuzA.checked,     A_LA: chkLuzAutoA.checked,     LB: chkLuzB.checked,     A_LB: chkLuzAutoB.checked,     LC: chkLuzC.checked,     A_LC: chkLuzAutoC.checked,     V: chkVent.checked,     TR: rngTref.value,     AR: rngRefLuzA.value,     BR: rngRefLuzB.value,     CR: rngRefLuzC.value,     PW: rngVentPow.value,     token: document.getElementById('token').value,     fin:null     }, function(data){mostrar(data);});   }  }  function mostrar(respuesta){   if(respuesta!='Token no valido'){    var valores = (respuesta.split(','));    document.getElementById('Tact').innerHTML=valores[0] + '\u00B0C';    document.getElementById('LDR_1').innerHTML=valores[1] + '%';    document.getElementById('LDR_2').innerHTML=valores[2] + '%';    document.getElementById('LDR_3').innerHTML=valores[3] + '%';    document.getElementById('V9V').innerHTML=valores[4] + ',' + valores[5] + 'V';    document.getElementById('V5V').innerHTML=valores[6] + ',' + valores[7] + 'V';    document.getElementById('V3V3').innerHTML=valores[8] + ',' + valores[9] + 'V';    if(parseInt(valores[11],10) < 10)     valores[11]='0'+valores[11];    if(parseInt(valores[12],10) < 10)     valores[12]='0'+valores[12];    if(parseInt(valores[13],10) < 10)     valores[13]='0'+valores[13];    if(parseInt(valores[14],10) < 10)     valores[14]='0'+valores[14];    if(parseInt(valores[15],10) < 10)     valores[15]='0'+valores[15];    if(parseInt(valores[16],10) < 10)     valores[16]='0'+valores[16];    document.getElementById('alertClock').innerHTML='<p align='center'><strong>Reloj del sistema:&nbsp;' + valores[10] + '&nbsp;' + valores[11] + '/' + valores[12] + '/20' + valores[13] + '&nbsp;&nbsp;&nbsp;&nbsp;' + valores[14] + ':' + valores[15] + ':' + valores[16] + '</strong></a>';   }   else{    clearInterval(x);    alert('Token no v\u00E1lido');   }  }  function actualizarRTC(){   if (((ajaxActualizar == null) || (ajaxActualizar.readyState==4) || (ajaxActualizar.readyState==0)) ){    var r=confirm('\u00BFDesea actualizar el reloj del sistema con la hora y fecha de este equipo?');    if (r==true){     var dateTime=new Date();     if(dateTime.getDate()<10){      var day='0' + dateTime.getDate();     }     else      var day=dateTime.getDate();      if((dateTime.getMonth() + 1) <10){      var month='0' + (dateTime.getMonth()+1);     }     else      var month=dateTime.getMonth() + 1;          var yr=dateTime.getFullYear() - 2000;          var dow=dateTime.getDay();          if(dateTime.getHours()<10){      var hrs='0' + dateTime.getHours();     }     else      var hrs=dateTime.getHours();          if(dateTime.getMinutes()<10){      var min='0' + dateTime.getMinutes();     }     else      var min=dateTime.getMinutes();          if(dateTime.getSeconds()<10){      var sec='0' + dateTime.getSeconds();     }     else      var sec=dateTime.getSeconds();           url=getAbsolutePath()+'actRTC';             ajaxActRTC=$.post(url,      {      Z:null,      A: day,      B: month,      C: yr,      D: dow,      E: hrs,      F: min,      G: sec,      token: document.getElementById('token').value,      }, function(data){alert(data); if(document.getElementById('alertInfo') != null) window.location.href=getAbsolutePath()+'viewlog?token='+document.getElementById('token').value;});    }   }  }  function btnBorrarClick(){   var r=confirm('\u00BFDesea eliminar todos los registros?');   if (r==true){    url=getAbsolutePath()+'eraseMem';    ajaxEraseMem=$.get(url, {token: document.getElementById('token').value},      function(data){alert(data);     window.location.href=getAbsolutePath()+'viewlog?token='+document.getElementById('token').value;     });       }  }  function btnPrevClick(){   window.location.href=getAbsolutePath()+'prev?' + 'token='+document.getElementById('token').value;  }  function btnNextClick(){   window.location.href=getAbsolutePath()+'next?' + 'token='+document.getElementById('token').value;  }  function getAbsolutePath() {   var loc = window.location;   var resultado = loc.origin + '/';   return resultado;  }  function cerrarSesion(){   var r=confirm('\u00BFDesea cerrar sesi\u00F3n en JRC - IoT Web Server?');   if (r==true){    window.location.href=getAbsolutePath()+'logout?' + 'token='+document.getElementById('token').value;    }  }  function homeClick(){   window.location.href=getAbsolutePath()+'home?' + 'token='+document.getElementById('token').value;  }  function visorClick(){   window.location.href=getAbsolutePath()+'viewlog?' + 'token='+document.getElementById('token').value;     } </script>";
